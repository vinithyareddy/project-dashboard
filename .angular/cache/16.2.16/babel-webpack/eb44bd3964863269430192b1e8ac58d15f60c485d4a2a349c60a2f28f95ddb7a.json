{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { take } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/firestore.service\";\nimport * as i2 from \"src/app/services/refresh.service\";\nimport * as i3 from \"@angular/common\";\nfunction CalendarComponent_div_31_div_1_ng_container_1_ng_container_4_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 19);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const task_r8 = ctx.$implicit;\n    i0.ɵɵclassMap(task_r8.status);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", task_r8.name, \" \");\n  }\n}\nfunction CalendarComponent_div_31_div_1_ng_container_1_ng_container_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 17);\n    i0.ɵɵtext(2, \"Tasks:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, CalendarComponent_div_31_div_1_ng_container_1_ng_container_4_div_3_Template, 2, 3, \"div\", 18);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const day_r3 = i0.ɵɵnextContext(2).$implicit;\n    const ctx_r5 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r5.getTasksForDate(day_r3));\n  }\n}\nfunction CalendarComponent_div_31_div_1_ng_container_1_ng_container_5_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 21);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const project_r11 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", project_r11.name, \" \");\n  }\n}\nfunction CalendarComponent_div_31_div_1_ng_container_1_ng_container_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 17);\n    i0.ɵɵtext(2, \"Project Deadlines:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, CalendarComponent_div_31_div_1_ng_container_1_ng_container_5_div_3_Template, 2, 1, \"div\", 20);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const day_r3 = i0.ɵɵnextContext(2).$implicit;\n    const ctx_r6 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r6.getProjectsForDate(day_r3));\n  }\n}\nfunction CalendarComponent_div_31_div_1_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 15);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 16);\n    i0.ɵɵtemplate(4, CalendarComponent_div_31_div_1_ng_container_1_ng_container_4_Template, 4, 1, \"ng-container\", 14);\n    i0.ɵɵtemplate(5, CalendarComponent_div_31_div_1_ng_container_1_ng_container_5_Template, 4, 1, \"ng-container\", 14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const day_r3 = i0.ɵɵnextContext().$implicit;\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(day_r3.getDate());\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.getTasksForDate(day_r3).length > 0);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.getProjectsForDate(day_r3).length > 0);\n  }\n}\nfunction CalendarComponent_div_31_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 13);\n    i0.ɵɵtemplate(1, CalendarComponent_div_31_div_1_ng_container_1_Template, 6, 3, \"ng-container\", 14);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const day_r3 = ctx.$implicit;\n    i0.ɵɵclassProp(\"empty\", !day_r3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", day_r3);\n  }\n}\nfunction CalendarComponent_div_31_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 11);\n    i0.ɵɵtemplate(1, CalendarComponent_div_31_div_1_Template, 2, 3, \"div\", 12);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const week_r1 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", week_r1);\n  }\n}\nexport let CalendarComponent = /*#__PURE__*/(() => {\n  class CalendarComponent {\n    constructor(firestoreService, refreshService) {\n      this.firestoreService = firestoreService;\n      this.refreshService = refreshService;\n      this.currentDate = new Date();\n      this.calendar = [];\n      this.tasks = [];\n      this.projects = [];\n      this.currentMonth = this.currentDate.getMonth();\n      this.currentYear = this.currentDate.getFullYear();\n    }\n    ngOnInit() {\n      this.generateCalendar();\n      this.loadData(); // 🔁 Initial fetch\n      // ✅ Reload on file upload\n      this.refreshService.refresh$.subscribe(() => {\n        this.loadData();\n      });\n    }\n    loadData() {\n      this.firestoreService.getTasks().pipe(take(1)).subscribe(tasks => {\n        this.tasks = tasks;\n      });\n      this.firestoreService.getProjects().pipe(take(1)).subscribe(projects => {\n        this.projects = projects;\n      });\n    }\n    generateCalendar() {\n      const firstDay = new Date(this.currentYear, this.currentMonth, 1);\n      const lastDay = new Date(this.currentYear, this.currentMonth + 1, 0);\n      const weeks = [];\n      let currentWeek = [];\n      const startingDay = firstDay.getDay();\n      for (let i = 0; i < startingDay; i++) currentWeek.push(null);\n      for (let day = 1; day <= lastDay.getDate(); day++) {\n        if (currentWeek.length === 7) {\n          weeks.push(currentWeek);\n          currentWeek = [];\n        }\n        currentWeek.push(new Date(this.currentYear, this.currentMonth, day));\n      }\n      while (currentWeek.length < 7) currentWeek.push(null);\n      weeks.push(currentWeek);\n      this.calendar = weeks;\n    }\n    getTasksForDate(date) {\n      if (!date) return [];\n      return this.tasks.filter(task => {\n        const taskDate = task.dueDate instanceof Date ? task.dueDate : task.dueDate.toDate();\n        return taskDate.getDate() === date.getDate() && taskDate.getMonth() === date.getMonth() && taskDate.getFullYear() === date.getFullYear();\n      });\n    }\n    getProjectsForDate(date) {\n      if (!date) return [];\n      return this.projects.filter(project => {\n        const projectDate = new Date(project.dueDate);\n        return projectDate.getDate() === date.getDate() && projectDate.getMonth() === date.getMonth() && projectDate.getFullYear() === date.getFullYear();\n      });\n    }\n    previousMonth() {\n      if (this.currentMonth === 0) {\n        this.currentMonth = 11;\n        this.currentYear--;\n      } else {\n        this.currentMonth--;\n      }\n      this.generateCalendar();\n    }\n    nextMonth() {\n      if (this.currentMonth === 11) {\n        this.currentMonth = 0;\n        this.currentYear++;\n      } else {\n        this.currentMonth++;\n      }\n      this.generateCalendar();\n    }\n    getMonthName() {\n      return new Date(this.currentYear, this.currentMonth).toLocaleString('default', {\n        month: 'long'\n      });\n    }\n    static {\n      this.ɵfac = function CalendarComponent_Factory(t) {\n        return new (t || CalendarComponent)(i0.ɵɵdirectiveInject(i1.FirestoreService), i0.ɵɵdirectiveInject(i2.RefreshService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: CalendarComponent,\n        selectors: [[\"app-calendar\"]],\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 32,\n        vars: 3,\n        consts: [[1, \"calendar-container\"], [1, \"calendar-header\"], [1, \"month-navigation\"], [1, \"month-year\"], [1, \"navigation-buttons\"], [1, \"nav-button\", 3, \"click\"], [1, \"calendar-grid\"], [1, \"weekday-header\"], [1, \"weekday\"], [1, \"calendar-days\"], [\"class\", \"week\", 4, \"ngFor\", \"ngForOf\"], [1, \"week\"], [\"class\", \"day\", 3, \"empty\", 4, \"ngFor\", \"ngForOf\"], [1, \"day\"], [4, \"ngIf\"], [1, \"date-number\"], [1, \"items-container\"], [1, \"item-label\"], [\"class\", \"task-item\", 3, \"class\", 4, \"ngFor\", \"ngForOf\"], [1, \"task-item\"], [\"class\", \"project-deadline-item\", 4, \"ngFor\", \"ngForOf\"], [1, \"project-deadline-item\"]],\n        template: function CalendarComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h1\");\n            i0.ɵɵtext(3, \"Calendar\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(4, \"div\", 2)(5, \"div\", 3);\n            i0.ɵɵtext(6);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(7, \"div\", 4)(8, \"button\", 5);\n            i0.ɵɵlistener(\"click\", function CalendarComponent_Template_button_click_8_listener() {\n              return ctx.previousMonth();\n            });\n            i0.ɵɵelementStart(9, \"span\");\n            i0.ɵɵtext(10, \"\\u2190\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(11, \"button\", 5);\n            i0.ɵɵlistener(\"click\", function CalendarComponent_Template_button_click_11_listener() {\n              return ctx.nextMonth();\n            });\n            i0.ɵɵelementStart(12, \"span\");\n            i0.ɵɵtext(13, \"\\u2192\");\n            i0.ɵɵelementEnd()()()()();\n            i0.ɵɵelementStart(14, \"div\", 6)(15, \"div\", 7)(16, \"div\", 8);\n            i0.ɵɵtext(17, \"Sun\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(18, \"div\", 8);\n            i0.ɵɵtext(19, \"Mon\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(20, \"div\", 8);\n            i0.ɵɵtext(21, \"Tue\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(22, \"div\", 8);\n            i0.ɵɵtext(23, \"Wed\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(24, \"div\", 8);\n            i0.ɵɵtext(25, \"Thu\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(26, \"div\", 8);\n            i0.ɵɵtext(27, \"Fri\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(28, \"div\", 8);\n            i0.ɵɵtext(29, \"Sat\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(30, \"div\", 9);\n            i0.ɵɵtemplate(31, CalendarComponent_div_31_Template, 2, 1, \"div\", 10);\n            i0.ɵɵelementEnd()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(6);\n            i0.ɵɵtextInterpolate2(\" \", ctx.getMonthName(), \" \", ctx.currentYear, \" \");\n            i0.ɵɵadvance(25);\n            i0.ɵɵproperty(\"ngForOf\", ctx.calendar);\n          }\n        },\n        dependencies: [CommonModule, i3.NgForOf, i3.NgIf],\n        styles: [\".calendar-container[_ngcontent-%COMP%]{padding:2rem;color:#000;background:#ffffff;border-radius:12px;min-height:calc(100vh - 4rem)}.calendar-header[_ngcontent-%COMP%]{margin-bottom:2rem}.calendar-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:500;margin-bottom:1.5rem}.month-navigation[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.month-year[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:500}.navigation-buttons[_ngcontent-%COMP%]{display:flex;gap:.5rem}.navigation-buttons[_ngcontent-%COMP%]   .nav-button[_ngcontent-%COMP%]{border:none;width:56px;height:56px;border-radius:8px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background-color .2s}.navigation-buttons[_ngcontent-%COMP%]   .nav-button[_ngcontent-%COMP%]:hover{background:#3a3d45}.calendar-grid[_ngcontent-%COMP%]{border-radius:12px;overflow:hidden}.weekday-header[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(7,1fr);background:#2a2d35;padding:.4rem}.weekday-header[_ngcontent-%COMP%]   .weekday[_ngcontent-%COMP%]{text-align:center;color:#a0aec0;font-weight:500;font-size:.9rem}.calendar-days[_ngcontent-%COMP%]   .week[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(7,1fr);border-bottom:1px solid #2a2d35}.calendar-days[_ngcontent-%COMP%]   .week[_ngcontent-%COMP%]:last-child{border-bottom:none}.calendar-days[_ngcontent-%COMP%]   .day[_ngcontent-%COMP%]{min-height:120px;padding:.5rem;border-right:1px solid #2a2d35;position:relative}.calendar-days[_ngcontent-%COMP%]   .day[_ngcontent-%COMP%]:last-child{border-right:none}.calendar-days[_ngcontent-%COMP%]   .day.empty[_ngcontent-%COMP%]{background:rgba(0,0,0,.2)}.date-number[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:500;margin-bottom:.5rem}.items-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.item-label[_ngcontent-%COMP%]{font-size:.75rem;color:#000;margin-top:.5rem;font-weight:500}.task-item[_ngcontent-%COMP%]{font-size:.8rem;padding:.25rem .5rem;border-radius:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.task-item.not-started[_ngcontent-%COMP%]{background:rgba(255,71,87,.1);color:#ff4757}.task-item.in-progress[_ngcontent-%COMP%]{background:rgba(255,145,0,.1);color:#ff9100}.task-item.completed[_ngcontent-%COMP%]{background:rgba(46,213,115,.1);color:#2ed573}.project-deadline-item[_ngcontent-%COMP%]{font-size:.8rem;padding:.25rem .5rem;border-radius:4px;background:rgba(150,150,150,.1);color:#000;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;border-left:3px solid #a0aec0}.no-items[_ngcontent-%COMP%]{font-size:.75rem;color:#000;font-style:italic}@media (max-width: 768px){.calendar-container[_ngcontent-%COMP%]{padding:1rem;overflow-x:hidden}.calendar-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem}.day[_ngcontent-%COMP%]{min-height:100px}.task-item[_ngcontent-%COMP%]{font-size:.75rem}}@media (max-width: 480px){.calendar-container[_ngcontent-%COMP%]{padding:.5rem;overflow-x:hidden}.calendar-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:.5rem}.calendar-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.6rem;margin-bottom:.5rem}.month-navigation[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.month-navigation[_ngcontent-%COMP%]   .month-year[_ngcontent-%COMP%]{font-size:1.2rem;margin-bottom:.5rem}.month-navigation[_ngcontent-%COMP%]   .navigation-buttons[_ngcontent-%COMP%]{gap:.3rem}.month-navigation[_ngcontent-%COMP%]   .navigation-buttons[_ngcontent-%COMP%]   .nav-button[_ngcontent-%COMP%]{width:44px;height:44px}.weekday-header[_ngcontent-%COMP%]   .weekday[_ngcontent-%COMP%]{font-size:.75rem}.calendar-days[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(7,1fr);gap:1px;width:100%}.calendar-days[_ngcontent-%COMP%]   .day[_ngcontent-%COMP%]{min-height:110px;padding:.4rem;font-size:.75rem;display:flex;flex-direction:column;align-items:flex-start;justify-content:flex-start;gap:.3rem;word-wrap:break-word;white-space:normal;overflow-wrap:break-word}.calendar-days[_ngcontent-%COMP%]   .day[_ngcontent-%COMP%]   .date-number[_ngcontent-%COMP%]{font-weight:700;font-size:.9rem;margin-bottom:.3rem}.calendar-days[_ngcontent-%COMP%]   .day[_ngcontent-%COMP%]   .task-item[_ngcontent-%COMP%], .calendar-days[_ngcontent-%COMP%]   .day[_ngcontent-%COMP%]   .project-deadline-item[_ngcontent-%COMP%]{font-size:.75rem;padding:.25rem .4rem;background:#f3f4f6;border-radius:4px;max-width:100%;white-space:normal;overflow:hidden;text-overflow:ellipsis;display:block}.item-label[_ngcontent-%COMP%]{font-size:.7rem}}\"]\n      });\n    }\n  }\n  return CalendarComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}