<div class="header-toolbar">
  <span class="spacer"></span>

  <!-- ðŸ“‚ File Upload Button -->
  <div class="upload-container">
    <label for="file-upload" class="upload-icon">
      <input id="file-upload" type="file" accept=".xlsx, .xls, .csv" hidden (change)="onFileUpload($event)" />
      <mat-icon matTooltip="Upload Excel/CSV">upload_file</mat-icon>
    </label>
    <mat-progress-spinner
      *ngIf="isUploading"
      diameter="24"
      mode="indeterminate"
      color="accent"
      class="upload-spinner"
    ></mat-progress-spinner>
  </div>

  <!-- ðŸŸ¢/ðŸ”´ Upload Status Message -->
  <div
    *ngIf="fileMessage"
    [ngClass]="{
      'success-msg': fileMessage.includes('âœ…'),
      'error-msg': fileMessage.includes('âŒ')
    }"
  >
    {{ fileMessage }}
  </div>

  <!-- âŒ› Progress Spinner -->
  <mat-progress-spinner
    *ngIf="isUploading"
    diameter="24"
    mode="indeterminate"
    color="accent"
    class="upload-spinner"
  ></mat-progress-spinner>

  <div class="header-actions">
    <!-- ðŸ‘¤ User Icon or Login -->
    <ng-container *ngIf="user$ | async as user; else loginBtn">
      <button mat-icon-button [matMenuTriggerFor]="userMenu" matTooltip="User Menu">
        <mat-icon>account_circle</mat-icon>
      </button>
      <mat-menu #userMenu="matMenu">
        <button mat-menu-item class="user-info-item">
          <mat-icon class="user-icon">mail</mat-icon>
          <span><strong>Email:</strong> {{ user.email }}</span>
        </button>
        <button mat-menu-item (click)="openChangePasswordDialog()">
          <mat-icon matTooltip="Change Password" class="user-icon">lock</mat-icon>
          <span>Change Password</span>
        </button>
        <button mat-menu-item (click)="logout()">
          <mat-icon matTooltip="Logout" class="user-icon">logout</mat-icon>
          <span>Logout</span>
        </button>
      </mat-menu>
    </ng-container>

    <!-- ðŸ” Login Button -->
    <ng-template #loginBtn>
      <button mat-icon-button [routerLink]="['/auth']" matTooltip="Login">
        <mat-icon matTooltip="Login">login</mat-icon>
      </button>
    </ng-template>
  </div>
</div>
